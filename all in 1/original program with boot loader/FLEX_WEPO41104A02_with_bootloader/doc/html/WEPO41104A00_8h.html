<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SPIKE 1.1: WEPO41104A00.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="PROM_RZ_LogoRGB_ohne_pos.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">SPIKE 1.1
   &#160;<span id="projectnumber">WEPO41104A00</span>
   </div>
   <div id="projectbrief">Firmware Flex</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_617804c1fb5864457089ac8352017473.html">P:</a>      </li>
      <li class="navelem"><a class="el" href="dir_32a483bf0a3b52f63a14e8b5d8ed9951.html">Projekte</a>      </li>
      <li class="navelem"><a class="el" href="dir_975359d4bb9ad371f47a6d51f510fe42.html">WEPO</a>      </li>
      <li class="navelem"><a class="el" href="dir_811a7d7d8695d83f4dd4bbafba86e8cf.html">Entwicklung</a>      </li>
      <li class="navelem"><a class="el" href="dir_2bba18886bf9e3ba484fd6b282926808.html">Software</a>      </li>
      <li class="navelem"><a class="el" href="dir_462254a389dbfe4f996bf1d55f845ea5.html">Firmware</a>      </li>
      <li class="navelem"><a class="el" href="dir_de79c7db4a54e93bc8646c129402e669.html">WEPO4110xA00_SPIKE_1.1</a>      </li>
      <li class="navelem"><a class="el" href="dir_cac09c55cc1c02197d3ccbb536a953f3.html">WEPO41104Axx_Flex</a>      </li>
      <li class="navelem"><a class="el" href="dir_7872b52c2bb8b45f885067de97d057d1.html">WEPO41104A00</a>      </li>
      <li class="navelem"><a class="el" href="dir_643384315c1bb2de5da6546bdb19fee5.html">inc</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">WEPO41104A00.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;inttypes.h&gt;</code><br/>
<code>#include &lt;avr/Interrupt.h&gt;</code><br/>
<code>#include &lt;avr/wdt.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;avr/sleep.h&gt;</code><br/>
<code>#include &lt;util/delay.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="eeprom__abbild_8h_source.html">eeprom_abbild.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SX8723c_8h_source.html">SX8723c.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ds620_8h_source.html">ds620.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="at86_8h_source.html">at86.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SPIKE__config_8h_source.html">SPIKE_config.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pm__config__protocol_8h_source.html">pm_config_protocol.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="conf__LED_8h_source.html">conf_LED.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for WEPO41104A00.h:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h__incl.png" border="0" usemap="#WEPO41104A00_8h" alt=""/></div>
<map name="WEPO41104A00_8h" id="WEPO41104A00_8h">
<area shape="rect" id="node17" href="eeprom__abbild_8h.html" title="EEPROM data structure and EEPROM I/O&#45;functions." alt="" coords="22,229,140,256"/><area shape="rect" id="node21" href="SPIKE__config_8h.html" title="SPIKE_config.h" alt="" coords="480,304,593,331"/><area shape="rect" id="node23" href="SX8723c_8h.html" title="Semtech SX8723c Service." alt="" coords="255,155,338,181"/><area shape="rect" id="node34" href="ds620_8h.html" title="ds620.h" alt="" coords="1500,155,1568,181"/><area shape="rect" id="node37" href="at86_8h.html" title="This file implements the API for the AT86RF231 radio transceiver." alt="" coords="781,155,840,181"/><area shape="rect" id="node56" href="pm__config__protocol_8h.html" title="pm_config_protocol.h" alt="" coords="1156,80,1301,107"/><area shape="rect" id="node67" href="conf__LED_8h.html" title="conf_LED.h" alt="" coords="1592,155,1681,181"/><area shape="rect" id="node27" href="sw__twi_8h.html" title="Software TWI for parallel read/write to I²C devices." alt="" coords="273,229,345,256"/><area shape="rect" id="node30" href="conf__sw__twi_8h.html" title="Software TWI for parallel read/write to I²C devices." alt="" coords="1271,304,1373,331"/><area shape="rect" id="node43" href="at86rf231_8h.html" title="File contains register and command defines specific for AT86RF231." alt="" coords="1186,229,1272,256"/><area shape="rect" id="node45" href="tal__constants_8h.html" title="This file contains constants used througthout the TAL." alt="" coords="879,229,989,256"/><area shape="rect" id="node47" href="ieee__const_8h.html" title="This header holds all IEEE 802.15.4&#45;2006 constants and attribute identifiers." alt="" coords="1014,229,1110,256"/><area shape="rect" id="node49" href="pal__config_8h.html" title="PAL configuration for ATmega1281." alt="" coords="574,229,665,256"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h__dep__incl.png" border="0" usemap="#WEPO41104A00_8hdep" alt=""/></div>
<map name="WEPO41104A00_8hdep" id="WEPO41104A00_8hdep">
<area shape="rect" id="node3" href="WEPO41104A00_8c.html" title="WEPO41104A00.c" alt="" coords="5,80,136,107"/></map>
</div>
</div>
<p><a href="WEPO41104A00_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr class="memitem:a43bafb28b29491ec7f871319b5a3b2f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a43bafb28b29491ec7f871319b5a3b2f8">F_CPU</a>&#160;&#160;&#160;10000000</td></tr>
<tr class="memitem:a00fb01449721637b05522f7dce004d82"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a00fb01449721637b05522f7dce004d82">SG_1</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:a12dfc14867c2e6f95cd72a522c096cc1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a12dfc14867c2e6f95cd72a522c096cc1">SG_2</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a9a44239083781468ed0f995387ac635d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a9a44239083781468ed0f995387ac635d">SG_3</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:a2bd4405aaa8c7ac662e5ce138ef0090b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a2bd4405aaa8c7ac662e5ce138ef0090b">SG_4</a>&#160;&#160;&#160;3</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4ae6edab9a918f82c63b98920fa10f1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a4ae6edab9a918f82c63b98920fa10f1c">avr_init</a> (void)</td></tr>
<tr class="memdesc:a4ae6edab9a918f82c63b98920fa10f1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Grundlegende initialisierungen des Controlers und der Peripherie.  <a href="#a4ae6edab9a918f82c63b98920fa10f1c"></a><br/></td></tr>
<tr class="memitem:ab15cf82f0329bc4d7262c03559eaaa8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#ab15cf82f0329bc4d7262c03559eaaa8e">init_adc</a> (void)</td></tr>
<tr class="memitem:a51d97a32f6f5162b3c8eab9d48d78b4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a51d97a32f6f5162b3c8eab9d48d78b4f">init_wdt</a> (void)</td></tr>
<tr class="memitem:ad39420cdd896dd12c68e36313139d0a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#ad39420cdd896dd12c68e36313139d0a5">ISR</a> (TIMER1_COMPA_vect)</td></tr>
<tr class="memdesc:ad39420cdd896dd12c68e36313139d0a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timerinterrupt, wird SAPLERATE mal in der Sekunde ausgeführt.  <a href="#ad39420cdd896dd12c68e36313139d0a5"></a><br/></td></tr>
<tr class="memitem:a36cd53f29e25f87810b0a5156616fb99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a36cd53f29e25f87810b0a5156616fb99">ISR</a> (ANALOG_COMP_vect)</td></tr>
<tr class="memdesc:a36cd53f29e25f87810b0a5156616fb99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt des analog-Komperators, wird ausgeführt, wenn die Radialbeschleunigung über 2g steigt.  <a href="#a36cd53f29e25f87810b0a5156616fb99"></a><br/></td></tr>
<tr class="memitem:a43905d6fb5c4d433a49f527fa6ab811f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a43905d6fb5c4d433a49f527fa6ab811f">ISR</a> (WDT_vect)</td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="memdesc:a840291bc02cba5474a4cb46a9b9566fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hauptroutine.  <a href="#a840291bc02cba5474a4cb46a9b9566fe"></a><br/></td></tr>
<tr class="memitem:ab9955d15183797bee64862444d572183"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#ab9955d15183797bee64862444d572183">send_all_data_rf231</a> (void)</td></tr>
<tr class="memdesc:ab9955d15183797bee64862444d572183"><td class="mdescLeft">&#160;</td><td class="mdescRight">sendet ein Datenpacket  <a href="#ab9955d15183797bee64862444d572183"></a><br/></td></tr>
<tr class="memitem:a8ea54d2c5521603b34fe4203c3b399f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a8ea54d2c5521603b34fe4203c3b399f0">set_sleep</a> (void)</td></tr>
<tr class="memdesc:a8ea54d2c5521603b34fe4203c3b399f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine zum Eintritt in den Standby-Modus.  <a href="#a8ea54d2c5521603b34fe4203c3b399f0"></a><br/></td></tr>
<tr class="memitem:aedc96a40e844bc2efc8bbef1b0782702"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#aedc96a40e844bc2efc8bbef1b0782702">start</a> (void)</td></tr>
<tr class="memdesc:aedc96a40e844bc2efc8bbef1b0782702"><td class="mdescLeft">&#160;</td><td class="mdescRight">Startroutine zum Verlassen des Standby-Modus.  <a href="#aedc96a40e844bc2efc8bbef1b0782702"></a><br/></td></tr>
<tr class="memitem:a7b8ab79df77b57475a5494f5f81c3bd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WEPO41104A00_8h.html#a7b8ab79df77b57475a5494f5f81c3bd9">timer_init</a> (void)</td></tr>
<tr class="memdesc:a7b8ab79df77b57475a5494f5f81c3bd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisiert den Timer1 auf Interrupt im Intervall der Samplerate.  <a href="#a7b8ab79df77b57475a5494f5f81c3bd9"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a43bafb28b29491ec7f871319b5a3b2f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="WEPO41104A00_8h.html#a43bafb28b29491ec7f871319b5a3b2f8">F_CPU</a>&#160;&#160;&#160;10000000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="WEPO41104A00_8h_source.html#l00013">13</a> of file <a class="el" href="WEPO41104A00_8h_source.html">WEPO41104A00.h</a>.</p>

</div>
</div>
<a class="anchor" id="a00fb01449721637b05522f7dce004d82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="WEPO41104A00_8h.html#a00fb01449721637b05522f7dce004d82">SG_1</a>&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="WEPO41104A00_8h_source.html#l00036">36</a> of file <a class="el" href="WEPO41104A00_8h_source.html">WEPO41104A00.h</a>.</p>

<p>Referenced by <a class="el" href="WEPO41104A00_8c_source.html#l00246">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a12dfc14867c2e6f95cd72a522c096cc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="WEPO41104A00_8h.html#a12dfc14867c2e6f95cd72a522c096cc1">SG_2</a>&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="WEPO41104A00_8h_source.html#l00037">37</a> of file <a class="el" href="WEPO41104A00_8h_source.html">WEPO41104A00.h</a>.</p>

<p>Referenced by <a class="el" href="WEPO41104A00_8c_source.html#l00246">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a9a44239083781468ed0f995387ac635d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="WEPO41104A00_8h.html#a9a44239083781468ed0f995387ac635d">SG_3</a>&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="WEPO41104A00_8h_source.html#l00038">38</a> of file <a class="el" href="WEPO41104A00_8h_source.html">WEPO41104A00.h</a>.</p>

<p>Referenced by <a class="el" href="WEPO41104A00_8c_source.html#l00246">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a2bd4405aaa8c7ac662e5ce138ef0090b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="WEPO41104A00_8h.html#a2bd4405aaa8c7ac662e5ce138ef0090b">SG_4</a>&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="WEPO41104A00_8h_source.html#l00039">39</a> of file <a class="el" href="WEPO41104A00_8h_source.html">WEPO41104A00.h</a>.</p>

<p>Referenced by <a class="el" href="WEPO41104A00_8c_source.html#l00246">main()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a4ae6edab9a918f82c63b98920fa10f1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="WEPO41104A00_8c.html#a4ae6edab9a918f82c63b98920fa10f1c">avr_init</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Grundlegende initialisierungen des Controlers und der Peripherie. </p>

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00396">396</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>References <a class="el" href="at86rf231_8c_source.html#l00038">at86rf231_init()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00223">besch_start_flag</a>, <a class="el" href="conf__sw__twi_8h_source.html#l00057">device_1</a>, <a class="el" href="conf__sw__twi_8h_source.html#l00058">device_2</a>, <a class="el" href="conf__sw__twi_8h_source.html#l00059">device_3</a>, <a class="el" href="conf__sw__twi_8h_source.html#l00060">device_4</a>, <a class="el" href="ds620_8c_source.html#l00013">ds620_twi_init()</a>, <a class="el" href="eeprom__abbild_8c_source.html#l00115">eeprom_read_config()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00234">eeprom_sram_data</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00453">init_adc()</a>, <a class="el" href="conf__LED_8h_source.html#l00012">INIT_LED</a>, <a class="el" href="SX8723c_8c_source.html#l00029">SX8723c_init()</a>, <a class="el" href="eeprom__abbild_8h_source.html#l00076">eeprom_data::timeout</a>, and <a class="el" href="WEPO41104A00_8c_source.html#l00383">timer_init()</a>.</p>

<p>Referenced by <a class="el" href="WEPO41104A00_8c_source.html#l00246">main()</a>.</p>
<div class="fragment"><pre class="fragment">{
    MCUCR &amp;= ~(1 &lt;&lt; PUD);   <span class="comment">// enable internal pull ups </span>

    PRR0 = 0x00;        <span class="comment">// power manager: enable all modules</span>

    <span class="comment">/* Set system clock prescaler */</span>
    CLKPR = 0x80;
    CLKPR = 0x00; <span class="comment">// prescaler to 1</span>

    DDRA = 0x00;
    PORTA = 0x1F;

    DDRB = 0xB1;
    PORTB = 0x50;

    DDRC = 0xC0;
    PORTC = 0x80;

    DDRD = (1 &lt;&lt; PIND4) | (1 &lt;&lt; PIND7);     <span class="comment">// 1 = output, 0 = input </span>
    PORTD = (1 &lt;&lt; PIND4) | ( 1 &lt;&lt; PIND7);   <span class="comment">// 1 = high, 0 = low </span>
    
    <a class="code" href="conf__LED_8h.html#a890a7b756538547816bf1d293d55f08f">INIT_LED</a>;
    
    DDRB |= (1 &lt;&lt; PINB4); <span class="comment">// ank debug</span>
    PORTB &amp;= ~(1 &lt;&lt; PINB4); <span class="comment">// (für Debugzwecke) ank </span>

    <a class="code" href="eeprom__abbild_8c.html#a741f4f6bf07cdfdbf182dd34028fdd12" title="Load configuration from internal EEPROM and save it in SRAM.">eeprom_read_config</a>(<a class="code" href="at86rf231_8c.html#aebe1dbaacda0e3af18b8493670264e91">ptr_eeprom_sram_data</a>);   <span class="comment">// store EEPROM data to SRAM (faster access)</span>

    <span class="comment">/* if timeout = 0 --&gt; deaktivate acceleration sensor, always on */</span>
    <span class="keywordflow">if</span> (<a class="code" href="pm__config__protocol_8h.html#a7f3aacb710fc6ba60196588850cf6d15">eeprom_sram_data</a>.<a class="code" href="structeeprom__data.html#af2be052f091d31f650c635f4bfd3f873">timeout</a> == 0)
    {
        <a class="code" href="pm__config__protocol_8h.html#a6ec8e1d5423a97287f5095d86ce2cff7">besch_start_flag</a> = 0;
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="pm__config__protocol_8h.html#a6ec8e1d5423a97287f5095d86ce2cff7">besch_start_flag</a> = 1;
    }
    
<span class="preprocessor">#if defined(USE_DS620)</span>
<span class="preprocessor"></span>    <a class="code" href="ds620_8c.html#a126fb46cf24425d874541b7f95a927b7" title="Initialisiert die TWI für den Temperatursensor.">ds620_twi_init</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <a class="code" href="group__group__SX8723c__service.html#ga528d11c1bcefe1ac4489e8dae24a4711">SX8723c_init</a>(<a class="code" href="conf__sw__twi_8h.html#a21cf31a4465229adb58665938b64811d">device_1</a>);
    <a class="code" href="group__group__SX8723c__service.html#ga528d11c1bcefe1ac4489e8dae24a4711">SX8723c_init</a>(<a class="code" href="conf__sw__twi_8h.html#a14594221af7e11a756654797e3a97491">device_2</a>);
    <a class="code" href="group__group__SX8723c__service.html#ga528d11c1bcefe1ac4489e8dae24a4711">SX8723c_init</a>(<a class="code" href="conf__sw__twi_8h.html#a90ca18d19efd874dcfab959b476c40aa">device_3</a>);
    <a class="code" href="group__group__SX8723c__service.html#ga528d11c1bcefe1ac4489e8dae24a4711">SX8723c_init</a>(<a class="code" href="conf__sw__twi_8h.html#a43e27f6fc03bf09854fc1d4170ceddf0">device_4</a>);

    ACSR = 0x82; <span class="comment">// analog-comparator off, comparator Interrupt on Falling Output Edge</span>
    <a class="code" href="WEPO41104A00_8h.html#a7b8ab79df77b57475a5494f5f81c3bd9" title="Initialisiert den Timer1 auf Interrupt im Intervall der Samplerate.">timer_init</a>(); <span class="comment">// timer initialization</span>
    
    <span class="comment">/* adc init */</span>
    <a class="code" href="WEPO41104A00_8h.html#ab15cf82f0329bc4d7262c03559eaaa8e">init_adc</a>();

    <a class="code" href="at86rf231_8c.html#a95cd6b5d19a0129a7b6ccb6ce985a790" title="Init AT86RF231 Transceiver.">at86rf231_init</a>();   <span class="comment">// AT86RF231 initialization</span>
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_a4ae6edab9a918f82c63b98920fa10f1c_cgraph.png" border="0" usemap="#WEPO41104A00_8h_a4ae6edab9a918f82c63b98920fa10f1c_cgraph" alt=""/></div>
<map name="WEPO41104A00_8h_a4ae6edab9a918f82c63b98920fa10f1c_cgraph" id="WEPO41104A00_8h_a4ae6edab9a918f82c63b98920fa10f1c_cgraph">
<area shape="rect" id="node3" href="at86rf231_8c.html#a95cd6b5d19a0129a7b6ccb6ce985a790" title="Init AT86RF231 Transceiver." alt="" coords="137,362,236,388"/><area shape="rect" id="node39" href="ds620_8c.html#a126fb46cf24425d874541b7f95a927b7" title="Initialisiert die TWI für den Temperatursensor." alt="" coords="135,424,239,451"/><area shape="rect" id="node41" href="eeprom__abbild_8c.html#a741f4f6bf07cdfdbf182dd34028fdd12" title="Load configuration from internal EEPROM and save it in SRAM." alt="" coords="117,475,256,502"/><area shape="rect" id="node43" href="WEPO41104A00_8h.html#ab15cf82f0329bc4d7262c03559eaaa8e" title="init_adc" alt="" coords="153,526,220,552"/><area shape="rect" id="node45" href="group__group__SX8723c__service.html#ga528d11c1bcefe1ac4489e8dae24a4711" title="SX8723c_init" alt="" coords="138,576,235,603"/><area shape="rect" id="node49" href="WEPO41104A00_8h.html#a7b8ab79df77b57475a5494f5f81c3bd9" title="Initialisiert den Timer1 auf Interrupt im Intervall der Samplerate." alt="" coords="149,627,224,654"/><area shape="rect" id="node5" href="at86rf231_8c.html#af609fd7593c4cc52caa234572c3a0f30" title="Apply channel page configuartion to transceiver." alt="" coords="304,159,515,186"/><area shape="rect" id="node7" href="at86_8h.html#ab06627709265af4e38e0eba63c6b59a9" title="read specified bit from transceiver" alt="" coords="796,463,911,490"/><area shape="rect" id="node9" href="at86_8h.html#a3b0bf90d2d517ddc581401bef389591d" title="read register from transceiver" alt="" coords="969,311,1087,338"/><area shape="rect" id="node11" href="at86_8h.html#abed0355d678d59c149f001310969044a" title="write specified bit to transceiver" alt="" coords="593,108,709,135"/><area shape="rect" id="node14" href="at86_8h.html#aa3bf62e2394e1a9b52fcd492c28f50dc" title="write register to transceiver" alt="" coords="793,210,913,236"/><area shape="rect" id="node19" href="at86_8h.html#a4ddebb432b1aef8f295d63c239e8c607" title="Enables the transceiver interrupt." alt="" coords="346,438,473,464"/><area shape="rect" id="node21" href="at86_8h.html#aceb006f750bff9f026625d1c9ba2085e" title="init external interrupt" alt="" coords="356,488,463,515"/><area shape="rect" id="node25" href="at86_8h.html#a77bbb8f8a76c36305d693461ad862b46" title="init spi interace" alt="" coords="351,539,468,566"/><area shape="rect" id="node27" href="at86rf231_8c.html#a1c1fedf9aed4fb4c3de561cfe89152d1" title="Transceiver interrupt handler." alt="" coords="345,336,473,363"/><area shape="rect" id="node29" href="at86rf231_8c.html#a3a3b1f218e1475f01a95710d06423393" title="Handle received frame interrupt." alt="" coords="563,362,738,388"/><area shape="rect" id="node32" href="at86_8h.html#a567fce74d2ddb73921f679c1a907cd2f" title="Upload frame from transceiver." alt="" coords="787,362,919,388"/><area shape="rect" id="node47" href="sw__twi_8h.html#a97a103cc9aeea7d86299b5c97b90751a" title="Brief description of this function." alt="" coords="313,590,506,616"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_a4ae6edab9a918f82c63b98920fa10f1c_icgraph.png" border="0" usemap="#WEPO41104A00_8h_a4ae6edab9a918f82c63b98920fa10f1c_icgraph" alt=""/></div>
<map name="WEPO41104A00_8h_a4ae6edab9a918f82c63b98920fa10f1c_icgraph" id="WEPO41104A00_8h_a4ae6edab9a918f82c63b98920fa10f1c_icgraph">
<area shape="rect" id="node3" href="WEPO41104A00_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="Hauptroutine." alt="" coords="117,5,168,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab15cf82f0329bc4d7262c03559eaaa8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="WEPO41104A00_8c.html#ab15cf82f0329bc4d7262c03559eaaa8e">init_adc</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00453">453</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>Referenced by <a class="el" href="WEPO41104A00_8c_source.html#l00396">avr_init()</a>, and <a class="el" href="WEPO41104A00_8c_source.html#l00462">start()</a>.</p>
<div class="fragment"><pre class="fragment">{
    ADMUX = (1 &lt;&lt; REFS1) | (1 &lt;&lt; ADLAR) | (1 &lt;&lt; MUX0) | (1 &lt;&lt; MUX1) | (1
            &lt;&lt; MUX2); <span class="comment">// ADC7, Left Adjust, 1.1V Ref</span>
    ADCSRA = (1 &lt;&lt; ADSC) | (1 &lt;&lt; ADATE) | (1 &lt;&lt; ADEN) | (1 &lt;&lt; ADPS2) | (1
            &lt;&lt; ADPS0); <span class="comment">// ADC enable, Start conversion, AutoTrigger enable, Prescaler: 32</span>
    ADCSRB = 0;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_ab15cf82f0329bc4d7262c03559eaaa8e_icgraph.png" border="0" usemap="#WEPO41104A00_8h_ab15cf82f0329bc4d7262c03559eaaa8e_icgraph" alt=""/></div>
<map name="WEPO41104A00_8h_ab15cf82f0329bc4d7262c03559eaaa8e_icgraph" id="WEPO41104A00_8h_ab15cf82f0329bc4d7262c03559eaaa8e_icgraph">
<area shape="rect" id="node3" href="WEPO41104A00_8c.html#a4ae6edab9a918f82c63b98920fa10f1c" title="Grundlegende initialisierungen des Controlers und der Peripherie." alt="" coords="121,5,183,32"/><area shape="rect" id="node7" href="WEPO41104A00_8c.html#aedc96a40e844bc2efc8bbef1b0782702" title="Startroutine zum Verlassen des Standby&#45;Modus." alt="" coords="128,56,176,83"/><area shape="rect" id="node5" href="WEPO41104A00_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="Hauptroutine." alt="" coords="232,5,283,32"/><area shape="rect" id="node9" href="WEPO41104A00_8c.html#a36cd53f29e25f87810b0a5156616fb99" title="Interrupt des analog&#45;Komperators, wird ausgeführt, wenn die Radialbeschleunigung über 2g steigt..." alt="" coords="236,56,279,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a51d97a32f6f5162b3c8eab9d48d78b4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="WEPO41104A00_8c.html#a51d97a32f6f5162b3c8eab9d48d78b4f">init_wdt</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00375">375</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//WDTCSR |= (1 &lt;&lt; WDCE) | (1 &lt;&lt; WDE);       // watchdog enable</span>
    WDTCSR |= ((1 &lt;&lt; WDCE) | (1 &lt;&lt; WDIE));      <span class="comment">// watchdog enable</span>
    WDTCSR = 0x29;                          <span class="comment">// Watchdog 8s, reset-mode</span>
    wdt_reset();    
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad39420cdd896dd12c68e36313139d0a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="WEPO41104A00_8c.html#a43905d6fb5c4d433a49f527fa6ab811f">ISR</a> </td>
          <td>(</td>
          <td class="paramtype">TIMER1_COMPA_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Timerinterrupt, wird SAPLERATE mal in der Sekunde ausgeführt. </p>

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00579">579</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>References <a class="el" href="WEPO41104A00_8c_source.html#l00224">timer_flag</a>.</p>
<div class="fragment"><pre class="fragment">{
    DDRA |= (1 &lt;&lt; PIND6);
    PORTA |= (1 &lt;&lt; PIND6); <span class="comment">// TXD auf 0 (für Debugzwecke) ank</span>
    <span class="comment">/* Reset timer flag */</span>
    <a class="code" href="WEPO41104A00_8c.html#accb4ae119b6b85eda30f468b716c6b83">timer_flag</a> = 1;
    
    <span class="comment">//sw_TWI_write_single_register(0x0F, 0x40, 0x55);   //ank</span>
    <span class="comment">//sw_TWI_read_value_registers(0x0F, p_test);    //ank</span>
    
    PORTA &amp;= ~(1 &lt;&lt; PIND6); <span class="comment">// TXD auf 0 (für Debugzwecke) ank</span>

}
</pre></div>
</div>
</div>
<a class="anchor" id="a36cd53f29e25f87810b0a5156616fb99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="WEPO41104A00_8c.html#a43905d6fb5c4d433a49f527fa6ab811f">ISR</a> </td>
          <td>(</td>
          <td class="paramtype">ANALOG_COMP_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Interrupt des analog-Komperators, wird ausgeführt, wenn die Radialbeschleunigung über 2g steigt. </p>

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00594">594</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>References <a class="el" href="WEPO41104A00_8c_source.html#l00462">start()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">/* Spike is not charging */</span>
    <span class="keywordflow">if</span>( !(PIND&amp;0x20) )
    {
        <span class="comment">/* start measuring */</span>
        <a class="code" href="WEPO41104A00_8h.html#aedc96a40e844bc2efc8bbef1b0782702" title="Startroutine zum Verlassen des Standby-Modus.">start</a>();
    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">/* sleep again if spike is already charging */</span>
        ACSR = 0x1A; <span class="comment">// analog-Komperator an, Interrupt bei fallender Flanke</span>
        set_sleep_mode(SLEEP_MODE_IDLE);
    
        wdt_reset();        <span class="comment">//ank</span>
        sleep_enable();
        sei();
        sleep_cpu(); <span class="comment">// IDLE-Modus</span>
        sleep_disable();
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_a36cd53f29e25f87810b0a5156616fb99_cgraph.png" border="0" usemap="#WEPO41104A00_8h_a36cd53f29e25f87810b0a5156616fb99_cgraph" alt=""/></div>
<map name="WEPO41104A00_8h_a36cd53f29e25f87810b0a5156616fb99_cgraph" id="WEPO41104A00_8h_a36cd53f29e25f87810b0a5156616fb99_cgraph">
<area shape="rect" id="node3" href="WEPO41104A00_8h.html#aedc96a40e844bc2efc8bbef1b0782702" title="Startroutine zum Verlassen des Standby&#45;Modus." alt="" coords="96,107,144,133"/><area shape="rect" id="node5" href="WEPO41104A00_8h.html#ab15cf82f0329bc4d7262c03559eaaa8e" title="init_adc" alt="" coords="212,56,279,83"/><area shape="rect" id="node7" href="ds620_8c.html#aa8ab08bf72368a272b8e137b37292ad9" title="Initialisiert den DS620." alt="" coords="205,107,286,133"/><area shape="rect" id="node17" href="group__group__SX8723c__service.html#ga6e062d659b6b58d80823c2b664ec17f0" title="SX8723c_start" alt="" coords="192,183,299,209"/><area shape="rect" id="node9" href="ds620_8c.html#a126fb46cf24425d874541b7f95a927b7" title="Initialisiert die TWI für den Temperatursensor." alt="" coords="392,5,496,32"/><area shape="rect" id="node11" href="ds620_8c.html#aeb28edfed306ba8eceff10e8636852f0" title="sendet ein Byte über die TWI" alt="" coords="387,56,501,83"/><area shape="rect" id="node13" href="ds620_8c.html#aff3cc7b39da66e7aba8c3027edf2f6f0" title="Erzeugt die I²C&#45;Startbedingung und sendet die Chipadresse." alt="" coords="387,107,501,133"/><area shape="rect" id="node15" href="ds620_8c.html#a7b0b36fec2acaa9f4592b3390c1f6976" title="Erzeugt eine Stop&#45;Bedingung auf der TWI." alt="" coords="388,157,500,184"/><area shape="rect" id="node19" href="sw__twi_8h.html#a97a103cc9aeea7d86299b5c97b90751a" title="Brief description of this function." alt="" coords="347,208,541,235"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a43905d6fb5c4d433a49f527fa6ab811f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="WEPO41104A00_8c.html#a43905d6fb5c4d433a49f527fa6ab811f">ISR</a> </td>
          <td>(</td>
          <td class="paramtype">WDT_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00616">616</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>References <a class="el" href="WEPO41104A00_8c_source.html#l00237">wdt_interrupt_occurred</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="WEPO41104A00_8c.html#a481483ea06e2337faecb21a949a199f5">wdt_interrupt_occurred</a> = <span class="keyword">true</span>;
}</pre></div>
</div>
</div>
<a class="anchor" id="a840291bc02cba5474a4cb46a9b9566fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="WEPO41104A00_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hauptroutine. </p>

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00246">246</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>References <a class="el" href="WEPO41104A00_8c_source.html#l00396">avr_init()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00223">besch_start_flag</a>, <a class="el" href="conf__sw__twi_8h_source.html#l00062">device_all</a>, <a class="el" href="ds620_8c_source.html#l00093">ds620_get_temperature()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00234">eeprom_sram_data</a>, <a class="el" href="conf__LED_8h_source.html#l00013">LED_OFF</a>, <a class="el" href="conf__LED_8h_source.html#l00014">LED_ON</a>, <a class="el" href="at86_8h_source.html#l00044">at86rf231_frame::payload</a>, <a class="el" href="pm__config__protocol_8c_source.html#l00012">pm_config_protocol()</a>, <a class="el" href="eeprom__abbild_8h_source.html#l00077">eeprom_data::samplerate</a>, <a class="el" href="at86_8h_source.html#l00028">SAMPLES_PER_PACKET</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00539">send_all_data_rf231()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00499">set_sleep()</a>, <a class="el" href="WEPO41104A00_8h_source.html#l00036">SG_1</a>, <a class="el" href="WEPO41104A00_8h_source.html#l00037">SG_2</a>, <a class="el" href="WEPO41104A00_8h_source.html#l00038">SG_3</a>, <a class="el" href="WEPO41104A00_8h_source.html#l00039">SG_4</a>, <a class="el" href="eeprom__abbild_8h_source.html#l00078">eeprom_data::SG_software_offset</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00462">start()</a>, <a class="el" href="at86_8h_source.html#l00052">spike_payload::strain_gauge</a>, <a class="el" href="SX8723c_8c_source.html#l00091">SX8723c_get_value()</a>, <a class="el" href="SX8723c_8c_source.html#l00357">SX8723c_send_request()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00226">temperature</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00228">temperature_timer</a>, <a class="el" href="eeprom__abbild_8h_source.html#l00076">eeprom_data::timeout</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00221">timeout_timer</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00224">timer_flag</a>, and <a class="el" href="WEPO41104A00_8c_source.html#l00222">timeslot_number</a>.</p>
<div class="fragment"><pre class="fragment">{
    cli();          <span class="comment">// clear interrupt</span>
    
    <span class="comment">// TODO remove or edit</span>
    <span class="comment">//init_wdt();       // watchdog initialization</span>
    <span class="comment">//init_wdt_int();</span>
    
    <a class="code" href="WEPO41104A00_8h.html#a4ae6edab9a918f82c63b98920fa10f1c" title="Grundlegende initialisierungen des Controlers und der Peripherie.">avr_init</a>();     <span class="comment">// controller initialization </span>
    
    int16_t SG_value[4] = {0};
    int16_t *p_SG_value = SG_value;

    <span class="comment">/* Use acceleration sensor? */</span>
    <span class="keywordflow">if</span> (<a class="code" href="pm__config__protocol_8h.html#a6ec8e1d5423a97287f5095d86ce2cff7">besch_start_flag</a>)
    {
        <span class="keywordflow">if</span> (!(ACSR &amp; 0x20)) 
            <a class="code" href="pm__config__protocol_8h.html#a8ea54d2c5521603b34fe4203c3b399f0">set_sleep</a>();    <span class="comment">// radial acceleration under threshold --&gt; sleep</span>
        <span class="keywordflow">else</span>
            <a class="code" href="WEPO41104A00_8h.html#aedc96a40e844bc2efc8bbef1b0782702" title="Startroutine zum Verlassen des Standby-Modus.">start</a>();        <span class="comment">// radial acceleration over threshold --&gt; start measurment</span>
    }
    <span class="keywordflow">else</span>
    {
        <span class="keywordflow">if</span> ( !(PIND &amp; 0x20))
            <a class="code" href="WEPO41104A00_8h.html#aedc96a40e844bc2efc8bbef1b0782702" title="Startroutine zum Verlassen des Standby-Modus.">start</a>();        <span class="comment">// Spike is not charging --&gt; start measurment</span>
        <span class="keywordflow">else</span>
            <a class="code" href="pm__config__protocol_8h.html#a8ea54d2c5521603b34fe4203c3b399f0">set_sleep</a>();    <span class="comment">// Spike is charging --&gt; sleep</span>
    }

    <span class="comment">/* ------------------ LOOP FOREVER ------------------------- */</span>
    <span class="keywordflow">for</span> (;;)
    {
        <span class="comment">/* REQ_CFG CMD received? */</span>
        <span class="keywordflow">if</span> (<a class="code" href="at86rf231_8c.html#aceef37c0e08c31ac1d803e98d9240804">at86rf231_rx_frame</a>.<a class="code" href="structat86rf231__frame.html#a5c856872df7ffcd650fb1c0ebe1f2f3e">payload</a>[0] != 0x00)
        {
            <span class="comment">/* Reset CMD */</span>
            <span class="comment">//at86rf231_rx_frame.payload[0] = 0x00;</span>

            _delay_ms(40); 

            <span class="comment">/* Receive and process data */</span>
            <a class="code" href="pm__config__protocol_8h.html#abcc456d73d4fc7a801c502e2ccf9b5c9" title="Behandelt empfangene Pakete zur Konfiguration.">pm_config_protocol</a>();
        }

        <span class="comment">/* If spike is charging --&gt; sleep mode */</span>
        <span class="keywordflow">if</span> (PIND &amp; 0x20)
        {
            <a class="code" href="pm__config__protocol_8h.html#a8ea54d2c5521603b34fe4203c3b399f0">set_sleep</a>();
        }

        <span class="comment">/* timeout occurred --&gt; sleep mode */</span>
        <span class="keywordflow">if</span> ((<a class="code" href="pm__config__protocol_8h.html#ab14eb7224e6881cf15cb95391749de25">timeout_timer</a> &gt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) <a class="code" href="pm__config__protocol_8h.html#a7f3aacb710fc6ba60196588850cf6d15">eeprom_sram_data</a>.<a class="code" href="structeeprom__data.html#af2be052f091d31f650c635f4bfd3f873">timeout</a> * <a class="code" href="pm__config__protocol_8h.html#a7f3aacb710fc6ba60196588850cf6d15">eeprom_sram_data</a>.<a class="code" href="structeeprom__data.html#a41f5e80711c080ba2e96138d33fd640e">samplerate</a>) &amp;&amp; <a class="code" href="pm__config__protocol_8h.html#a6ec8e1d5423a97287f5095d86ce2cff7">besch_start_flag</a>)
        {
            <a class="code" href="pm__config__protocol_8h.html#ab14eb7224e6881cf15cb95391749de25">timeout_timer</a> = 0;
            <a class="code" href="pm__config__protocol_8h.html#a8ea54d2c5521603b34fe4203c3b399f0">set_sleep</a>();
        }

        <span class="comment">/* Radialbeschleunigung vorhanden: timeout_timer zurücksetzten */</span>
        <span class="keywordflow">if</span> ((<a class="code" href="pm__config__protocol_8h.html#a6ec8e1d5423a97287f5095d86ce2cff7">besch_start_flag</a> == 1) &amp;&amp; (!(ACSR &amp; 0x20)))
        {
            <a class="code" href="pm__config__protocol_8h.html#ab14eb7224e6881cf15cb95391749de25">timeout_timer</a> = 0;
        }

        <span class="keywordflow">if</span> (<a class="code" href="WEPO41104A00_8c.html#accb4ae119b6b85eda30f468b716c6b83">timer_flag</a>)
        {
            <a class="code" href="WEPO41104A00_8c.html#accb4ae119b6b85eda30f468b716c6b83">timer_flag</a> = 0;
            
            <span class="comment">/* increase timeout_timer */</span>
            <a class="code" href="pm__config__protocol_8h.html#ab14eb7224e6881cf15cb95391749de25">timeout_timer</a>++;
            
<span class="preprocessor">            #if defined(USE_DS620)</span>
<span class="preprocessor"></span>            <span class="comment">// increase temperature timer</span>
            <a class="code" href="WEPO41104A00_8c.html#a6a816a46f11405edf3d5659f16cf292a">temperature_timer</a>++;
<span class="preprocessor">            #endif</span>
<span class="preprocessor"></span>            
            <a class="code" href="conf__LED_8h.html#af2e697ac60e05813d45ea2c9c9e79c25">LED_ON</a>; 
            <span class="comment">/* Read data from Sx8723c 1-4 */</span>
            <a class="code" href="group__group__SX8723c__service.html#ga0a84d3b06d6266f36c42a8733fb06db8">SX8723c_send_request</a>(<a class="code" href="conf__sw__twi_8h.html#a7bdb5039dd8160773adc99bf5b068a1a">device_all</a>);   <span class="comment">// TODO wieder anschalten</span>
            
            <span class="comment">//DDRB |= (1 &lt;&lt; PINB4); // ank</span>
            <span class="comment">//PORTB |= (1 &lt;&lt; PINB4); // (für Debugzwecke) ank</span>
            <a class="code" href="group__group__SX8723c__service.html#ga3e3069b7bc89d4641dc095f22e24d136">SX8723c_get_value</a>(<a class="code" href="conf__sw__twi_8h.html#a7bdb5039dd8160773adc99bf5b068a1a">device_all</a>, p_SG_value);
            <span class="comment">//PORTB &amp;= ~(1 &lt;&lt; PINB4); // (für Debugzwecke) ank</span>
            
            <a class="code" href="conf__LED_8h.html#a80700bb63bd56ebabbb4728aa433fd29">LED_OFF</a>; 
            
            <span class="comment">/* store data in payload */</span>
            <a class="code" href="ZMD_8h.html#aeafeea74e76af10844f9a3c97db6712e">ptr_payload_spike</a>-&gt;<a class="code" href="structspike__payload.html#adcbddf2044dfae793b1899facff69eee">strain_gauge</a>[<a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a>][<a class="code" href="WEPO41104A00_8h.html#a00fb01449721637b05522f7dce004d82">SG_1</a>] = SG_value[<a class="code" href="WEPO41104A00_8h.html#a00fb01449721637b05522f7dce004d82">SG_1</a>] - <a class="code" href="at86rf231_8c.html#aebe1dbaacda0e3af18b8493670264e91">ptr_eeprom_sram_data</a>-&gt;<a class="code" href="structeeprom__data.html#a4e2ee5aa1a05e9e5c607e9b7322b28b1">SG_software_offset</a>[<a class="code" href="WEPO41104A00_8h.html#a00fb01449721637b05522f7dce004d82">SG_1</a>];
            <a class="code" href="ZMD_8h.html#aeafeea74e76af10844f9a3c97db6712e">ptr_payload_spike</a>-&gt;<a class="code" href="structspike__payload.html#adcbddf2044dfae793b1899facff69eee">strain_gauge</a>[<a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a>][<a class="code" href="WEPO41104A00_8h.html#a12dfc14867c2e6f95cd72a522c096cc1">SG_2</a>] = SG_value[<a class="code" href="WEPO41104A00_8h.html#a12dfc14867c2e6f95cd72a522c096cc1">SG_2</a>] - <a class="code" href="at86rf231_8c.html#aebe1dbaacda0e3af18b8493670264e91">ptr_eeprom_sram_data</a>-&gt;<a class="code" href="structeeprom__data.html#a4e2ee5aa1a05e9e5c607e9b7322b28b1">SG_software_offset</a>[<a class="code" href="WEPO41104A00_8h.html#a12dfc14867c2e6f95cd72a522c096cc1">SG_2</a>];
            <a class="code" href="ZMD_8h.html#aeafeea74e76af10844f9a3c97db6712e">ptr_payload_spike</a>-&gt;<a class="code" href="structspike__payload.html#adcbddf2044dfae793b1899facff69eee">strain_gauge</a>[<a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a>][<a class="code" href="WEPO41104A00_8h.html#a9a44239083781468ed0f995387ac635d">SG_3</a>] = SG_value[<a class="code" href="WEPO41104A00_8h.html#a9a44239083781468ed0f995387ac635d">SG_3</a>] - <a class="code" href="at86rf231_8c.html#aebe1dbaacda0e3af18b8493670264e91">ptr_eeprom_sram_data</a>-&gt;<a class="code" href="structeeprom__data.html#a4e2ee5aa1a05e9e5c607e9b7322b28b1">SG_software_offset</a>[<a class="code" href="WEPO41104A00_8h.html#a9a44239083781468ed0f995387ac635d">SG_3</a>];
            <a class="code" href="ZMD_8h.html#aeafeea74e76af10844f9a3c97db6712e">ptr_payload_spike</a>-&gt;<a class="code" href="structspike__payload.html#adcbddf2044dfae793b1899facff69eee">strain_gauge</a>[<a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a>][<a class="code" href="WEPO41104A00_8h.html#a2bd4405aaa8c7ac662e5ce138ef0090b">SG_4</a>] = SG_value[<a class="code" href="WEPO41104A00_8h.html#a2bd4405aaa8c7ac662e5ce138ef0090b">SG_4</a>] - <a class="code" href="at86rf231_8c.html#aebe1dbaacda0e3af18b8493670264e91">ptr_eeprom_sram_data</a>-&gt;<a class="code" href="structeeprom__data.html#a4e2ee5aa1a05e9e5c607e9b7322b28b1">SG_software_offset</a>[<a class="code" href="WEPO41104A00_8h.html#a2bd4405aaa8c7ac662e5ce138ef0090b">SG_4</a>];
    
            <span class="comment">/* Timeslot++ */</span>
            <a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a>++;

            <span class="comment">/* send data with radio if necessary */</span>
            <span class="keywordflow">if</span> (<a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a> &gt;= <a class="code" href="at86_8h.html#ae6e677a01ad8ab8134ffc7a68b814048">SAMPLES_PER_PACKET</a>)
            {
                <a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a> = 0;
                <a class="code" href="WEPO41104A00_8c.html#ab9955d15183797bee64862444d572183">send_all_data_rf231</a>();
            }               
            
            <span class="comment">/* Reset watchdog */</span>
            wdt_reset();
        }

        
<span class="preprocessor">#if defined(USE_DS620)</span>
<span class="preprocessor"></span>        <span class="comment">// Temperaturmessung staren wenn 200ms vorbei und DMS gerade nicht messen und nicht gesendet wird.</span>
        <span class="keywordflow">if</span>( (<a class="code" href="WEPO41104A00_8c.html#a6a816a46f11405edf3d5659f16cf292a">temperature_timer</a> &gt;= (<a class="code" href="pm__config__protocol_8h.html#a7f3aacb710fc6ba60196588850cf6d15">eeprom_sram_data</a>.<a class="code" href="structeeprom__data.html#a41f5e80711c080ba2e96138d33fd640e">samplerate</a> / 9)) &amp; (<a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a> == 3))
        {
                    <a class="code" href="WEPO41104A00_8c.html#a38c1c68ba82dd107cf6dddbc7a564dfd">temperature</a> = <a class="code" href="ds620_8c.html#a3f2e6a267be5098a09273824a5887d74" title="liest einen Temperaturwert vom DS620">ds620_get_temperature</a>();
                    <a class="code" href="WEPO41104A00_8c.html#a6a816a46f11405edf3d5659f16cf292a">temperature_timer</a> = 0;
        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    } <span class="comment">// end for()</span>
    <span class="keywordflow">return</span> (0);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_a840291bc02cba5474a4cb46a9b9566fe_cgraph.png" border="0" usemap="#WEPO41104A00_8h_a840291bc02cba5474a4cb46a9b9566fe_cgraph" alt=""/></div>
<map name="WEPO41104A00_8h_a840291bc02cba5474a4cb46a9b9566fe_cgraph" id="WEPO41104A00_8h_a840291bc02cba5474a4cb46a9b9566fe_cgraph">
<area shape="rect" id="node3" href="WEPO41104A00_8h.html#a4ae6edab9a918f82c63b98920fa10f1c" title="Grundlegende initialisierungen des Controlers und der Peripherie." alt="" coords="142,876,205,902"/><area shape="rect" id="node53" href="ds620_8c.html#a3f2e6a267be5098a09273824a5887d74" title="liest einen Temperaturwert vom DS620" alt="" coords="291,420,450,446"/><area shape="rect" id="node63" href="pm__config__protocol_8h.html#abcc456d73d4fc7a801c502e2ccf9b5c9" title="Behandelt empfangene Pakete zur Konfiguration." alt="" coords="106,420,241,446"/><area shape="rect" id="node100" href="pm__config__protocol_8h.html#a8ea54d2c5521603b34fe4203c3b399f0" title="set_sleep" alt="" coords="331,673,410,700"/><area shape="rect" id="node105" href="group__group__SX8723c__service.html#ga0a84d3b06d6266f36c42a8733fb06db8" title="SX8723c_send_request" alt="" coords="525,774,683,801"/><area shape="rect" id="node108" href="group__group__SX8723c__service.html#ga3e3069b7bc89d4641dc095f22e24d136" title="SX8723c_get_value" alt="" coords="537,876,671,902"/><area shape="rect" id="node113" href="WEPO41104A00_8c.html#ab9955d15183797bee64862444d572183" title="send_all_data_rf231" alt="" coords="105,192,242,218"/><area shape="rect" id="node120" href="WEPO41104A00_8h.html#aedc96a40e844bc2efc8bbef1b0782702" title="Startroutine zum Verlassen des Standby&#45;Modus." alt="" coords="149,762,197,789"/><area shape="rect" id="node5" href="at86rf231_8c.html#a95cd6b5d19a0129a7b6ccb6ce985a790" title="Init AT86RF231 Transceiver." alt="" coords="321,1129,420,1156"/><area shape="rect" id="node41" href="ds620_8c.html#a126fb46cf24425d874541b7f95a927b7" title="Initialisiert die TWI für den Temperatursensor." alt="" coords="552,572,656,598"/><area shape="rect" id="node43" href="eeprom__abbild_8c.html#a741f4f6bf07cdfdbf182dd34028fdd12" title="Load configuration from internal EEPROM and save it in SRAM." alt="" coords="301,926,440,953"/><area shape="rect" id="node45" href="WEPO41104A00_8h.html#ab15cf82f0329bc4d7262c03559eaaa8e" title="init_adc" alt="" coords="337,825,404,852"/><area shape="rect" id="node47" href="group__group__SX8723c__service.html#ga528d11c1bcefe1ac4489e8dae24a4711" title="SX8723c_init" alt="" coords="322,876,419,902"/><area shape="rect" id="node51" href="WEPO41104A00_8h.html#a7b8ab79df77b57475a5494f5f81c3bd9" title="Initialisiert den Timer1 auf Interrupt im Intervall der Samplerate." alt="" coords="333,724,408,750"/><area shape="rect" id="node7" href="at86rf231_8c.html#af609fd7593c4cc52caa234572c3a0f30" title="Apply channel page configuartion to transceiver." alt="" coords="499,622,709,649"/><area shape="rect" id="node9" href="at86_8h.html#ab06627709265af4e38e0eba63c6b59a9" title="read specified bit from transceiver" alt="" coords="1009,914,1124,941"/><area shape="rect" id="node11" href="at86_8h.html#a3b0bf90d2d517ddc581401bef389591d" title="read register from transceiver" alt="" coords="1182,1009,1301,1036"/><area shape="rect" id="node13" href="at86_8h.html#abed0355d678d59c149f001310969044a" title="write specified bit to transceiver" alt="" coords="797,521,913,548"/><area shape="rect" id="node16" href="at86_8h.html#aa3bf62e2394e1a9b52fcd492c28f50dc" title="write register to transceiver" alt="" coords="1007,420,1127,446"/><area shape="rect" id="node21" href="at86_8h.html#a4ddebb432b1aef8f295d63c239e8c607" title="Enables the transceiver interrupt." alt="" coords="541,1129,667,1156"/><area shape="rect" id="node23" href="at86_8h.html#aceb006f750bff9f026625d1c9ba2085e" title="init external interrupt" alt="" coords="551,1230,657,1257"/><area shape="rect" id="node27" href="at86_8h.html#a77bbb8f8a76c36305d693461ad862b46" title="init spi interace" alt="" coords="545,1281,663,1308"/><area shape="rect" id="node29" href="at86rf231_8c.html#a1c1fedf9aed4fb4c3de561cfe89152d1" title="Transceiver interrupt handler." alt="" coords="540,1180,668,1206"/><area shape="rect" id="node31" href="at86rf231_8c.html#a3a3b1f218e1475f01a95710d06423393" title="Handle received frame interrupt." alt="" coords="767,1180,942,1206"/><area shape="rect" id="node34" href="at86_8h.html#a567fce74d2ddb73921f679c1a907cd2f" title="Upload frame from transceiver." alt="" coords="1001,1180,1133,1206"/><area shape="rect" id="node49" href="sw__twi_8h.html#a97a103cc9aeea7d86299b5c97b90751a" title="Brief description of this function." alt="" coords="758,762,951,789"/><area shape="rect" id="node55" href="ds620_8c.html#a5ee725e7e6d57c145a1d11e69380ef20" title="liest ein Byte von der TWI" alt="" coords="548,369,660,396"/><area shape="rect" id="node57" href="ds620_8c.html#aeb28edfed306ba8eceff10e8636852f0" title="sendet ein Byte über die TWI" alt="" coords="547,521,661,548"/><area shape="rect" id="node59" href="ds620_8c.html#aff3cc7b39da66e7aba8c3027edf2f6f0" title="Erzeugt die I²C&#45;Startbedingung und sendet die Chipadresse." alt="" coords="547,420,661,446"/><area shape="rect" id="node61" href="ds620_8c.html#a7b0b36fec2acaa9f4592b3390c1f6976" title="Erzeugt eine Stop&#45;Bedingung auf der TWI." alt="" coords="548,470,660,497"/><area shape="rect" id="node65" href="at86rf231_8c.html#a0da266448f852413ba43e88e4ea99a84" title="Apply channel to transceiver." alt="" coords="516,268,692,294"/><area shape="rect" id="node71" href="at86rf231_8c.html#a4c8415e4daa3241fe710fed12dcc503d" title="Apply tx power to transceiver." alt="" coords="519,318,689,345"/><area shape="rect" id="node76" href="at86rf231_8c.html#a0ee158241f405a92e7fa7b507c707f93" title="Send data request and receive data with ACK and retry." alt="" coords="305,268,437,294"/><area shape="rect" id="node80" href="at86rf231_8c.html#ab8a9e9b9256831427ca7746ec45e6345" title="Switch transceiver pll on and wait until it is locked." alt="" coords="775,217,935,244"/><area shape="rect" id="node96" href="eeprom__abbild_8c.html#a58027566fc3bbb855ac7f4730c3c542a" title="Laod configuration from internal SRAM and write it to EEPROM." alt="" coords="301,217,440,244"/><area shape="rect" id="node102" href="group__group__SX8723c__service.html#gab11943a993743ad594e4e4d622d6a94a" title="This function compensate an offset automatically." alt="" coords="299,572,442,598"/><area shape="rect" id="node78" href="at86rf231_8c.html#a70a4bd7b72126a48c196271354e6fff3" title="Set Transceiver State = RX_AACK_ON send ACK&#45;Frame automatically if requested." alt="" coords="513,116,695,142"/><area shape="rect" id="node86" href="at86rf231_8c.html#a7e0927379d6138f1c424a55b84d9955c" title="Sends frame." alt="" coords="526,217,682,244"/><area shape="rect" id="node91" href="at86_8h.html#a89baa48c35c21c98b853f56ad42b9da6" title="write frame to transceiver" alt="" coords="787,166,922,193"/><area shape="rect" id="node110" href="sw__twi_8h.html#afe1b60a74e56c732d4a85b536811b3d1" title="sw_TWI_read_value_registers" alt="" coords="758,876,951,902"/><area shape="rect" id="node115" href="at86rf231_8c.html#a9e5cb2ff642e1ad6dcb9c02bafd10229" title="Send data without ACK and Retry." alt="" coords="557,14,651,41"/><area shape="rect" id="node123" href="ds620_8c.html#aa8ab08bf72368a272b8e137b37292ad9" title="Initialisiert den DS620." alt="" coords="330,470,411,497"/><area shape="rect" id="node129" href="group__group__SX8723c__service.html#ga6e062d659b6b58d80823c2b664ec17f0" title="SX8723c_start" alt="" coords="317,774,424,801"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab9955d15183797bee64862444d572183"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="WEPO41104A00_8c.html#ab9955d15183797bee64862444d572183">send_all_data_rf231</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sendet ein Datenpacket </p>

</div>
</div>
<a class="anchor" id="a8ea54d2c5521603b34fe4203c3b399f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="WEPO41104A00_8c.html#a8ea54d2c5521603b34fe4203c3b399f0">set_sleep</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Routine zum Eintritt in den Standby-Modus. </p>

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00499">499</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>References <a class="el" href="at86rf231_8c_source.html#l00200">at86rf231_sleep()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00223">besch_start_flag</a>, <a class="el" href="conf__sw__twi_8h_source.html#l00062">device_all</a>, <a class="el" href="ds620_8c_source.html#l00085">ds620_sleep()</a>, and <a class="el" href="SX8723c_8c_source.html#l00367">SX8723c_sleep()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cli();
    
    TCCR1B = 0x00; <span class="comment">// Timer stoppen</span>
    TIFR1 = 0x02; <span class="comment">// Output Compare A Match Flag reset</span>
    
    <span class="comment">// SX8723c and strain gauges off</span>
    <a class="code" href="group__group__SX8723c__service.html#ga0d15afac6ea5710926527bcfd9cfb4c8">SX8723c_sleep</a>(<a class="code" href="conf__sw__twi_8h.html#a7bdb5039dd8160773adc99bf5b068a1a">device_all</a>);

<span class="preprocessor">#if defined(USE_DS620)</span>
<span class="preprocessor"></span>    <a class="code" href="ds620_8c.html#a7e0a9a05879cfb77b9cd5abc9bd545fa" title="versetzt den DS620 in den Sleep-Modus">ds620_sleep</a>(); <span class="comment">// Temperatursensor stoppen</span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    ADCSRA = 0x00; <span class="comment">// ADC off</span>
    
    <a class="code" href="at86rf231_8c.html#ad4bc4925ecdde78387866127fb66d3b3" title="Set Transceiver mode = sleep.">at86rf231_sleep</a>(); <span class="comment">// Transceiver in Power-down</span>
    
    CLKPR = 0x80;
    CLKPR = 0x03; <span class="comment">//08         // Prescaler 8</span>

    PRR0 = 0xFE;

    <span class="keywordflow">if</span> (<a class="code" href="pm__config__protocol_8h.html#a6ec8e1d5423a97287f5095d86ce2cff7">besch_start_flag</a>)
    {
        ACSR = 0x1A; <span class="comment">// analog-Komperator an, Interrupt bei fallender Flanke</span>
        set_sleep_mode(SLEEP_MODE_IDLE);
    }
    <span class="keywordflow">else</span>
    {
        set_sleep_mode(SLEEP_MODE_PWR_SAVE);
    }
    
    wdt_reset();        <span class="comment">//ank</span>
    sleep_enable();
    sei();
    sleep_cpu(); <span class="comment">// IDLE-Modus</span>
    sleep_disable();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_a8ea54d2c5521603b34fe4203c3b399f0_cgraph.png" border="0" usemap="#WEPO41104A00_8h_a8ea54d2c5521603b34fe4203c3b399f0_cgraph" alt=""/></div>
<map name="WEPO41104A00_8h_a8ea54d2c5521603b34fe4203c3b399f0_cgraph" id="WEPO41104A00_8h_a8ea54d2c5521603b34fe4203c3b399f0_cgraph">
<area shape="rect" id="node3" href="at86rf231_8c.html#ad4bc4925ecdde78387866127fb66d3b3" title="Set Transceiver mode = sleep." alt="" coords="134,31,247,57"/><area shape="rect" id="node7" href="ds620_8c.html#a7e0a9a05879cfb77b9cd5abc9bd545fa" title="versetzt den DS620 in den Sleep&#45;Modus" alt="" coords="143,107,238,133"/><area shape="rect" id="node15" href="group__group__SX8723c__service.html#ga0d15afac6ea5710926527bcfd9cfb4c8" title="SX8723c_sleep" alt="" coords="135,183,246,209"/><area shape="rect" id="node5" href="at86_8h.html#aa3bf62e2394e1a9b52fcd492c28f50dc" title="write register to transceiver" alt="" coords="333,5,453,32"/><area shape="rect" id="node9" href="ds620_8c.html#aeb28edfed306ba8eceff10e8636852f0" title="sendet ein Byte über die TWI" alt="" coords="336,56,451,83"/><area shape="rect" id="node11" href="ds620_8c.html#aff3cc7b39da66e7aba8c3027edf2f6f0" title="Erzeugt die I²C&#45;Startbedingung und sendet die Chipadresse." alt="" coords="337,107,450,133"/><area shape="rect" id="node13" href="ds620_8c.html#a7b0b36fec2acaa9f4592b3390c1f6976" title="Erzeugt eine Stop&#45;Bedingung auf der TWI." alt="" coords="337,157,449,184"/><area shape="rect" id="node17" href="sw__twi_8h.html#a97a103cc9aeea7d86299b5c97b90751a" title="Brief description of this function." alt="" coords="297,208,490,235"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aedc96a40e844bc2efc8bbef1b0782702"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="WEPO41104A00_8c.html#aedc96a40e844bc2efc8bbef1b0782702">start</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Startroutine zum Verlassen des Standby-Modus. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">aos</td><td>wenn AUTOOFFSET gesetzt ist: 0: kein Offsetabgleich, sonst Offsetabgeich ausführen </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00462">462</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>References <a class="el" href="WEPO41104A00_8c_source.html#l00223">besch_start_flag</a>, <a class="el" href="conf__sw__twi_8h_source.html#l00062">device_all</a>, <a class="el" href="ds620_8c_source.html#l00073">ds620_init()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00453">init_adc()</a>, <a class="el" href="SX8723c_8c_source.html#l00377">SX8723c_start()</a>, <a class="el" href="WEPO41104A00_8c_source.html#l00221">timeout_timer</a>, and <a class="el" href="WEPO41104A00_8c_source.html#l00222">timeslot_number</a>.</p>

<p>Referenced by <a class="el" href="WEPO41104A00_8c_source.html#l00594">ISR()</a>, and <a class="el" href="WEPO41104A00_8c_source.html#l00246">main()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cli();
    
    PRR0 = 0x00;        <span class="comment">// power manager: enable all modules</span>
    
    <span class="comment">/* Set system clock prescaler */</span>
    CLKPR = 0x80;
    CLKPR = 0x00; <span class="comment">// prescaler to 1</span>

    <span class="keywordflow">if</span> (<a class="code" href="pm__config__protocol_8h.html#a6ec8e1d5423a97287f5095d86ce2cff7">besch_start_flag</a>)
    {
        ACSR = 0x12; <span class="comment">// analog-Komperator an, Interrupt aus</span>
    }
    
    <span class="comment">/* adc init */</span>
    <a class="code" href="WEPO41104A00_8h.html#ab15cf82f0329bc4d7262c03559eaaa8e">init_adc</a>();

<span class="preprocessor">#if defined(USE_DS620)</span>
<span class="preprocessor"></span>    <span class="comment">/* init temperature sensor */</span>
    <a class="code" href="ds620_8c.html#aa8ab08bf72368a272b8e137b37292ad9" title="Initialisiert den DS620.">ds620_init</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <a class="code" href="group__group__SX8723c__service.html#ga6e062d659b6b58d80823c2b664ec17f0">SX8723c_start</a>(<a class="code" href="conf__sw__twi_8h.html#a7bdb5039dd8160773adc99bf5b068a1a">device_all</a>);
    
    <span class="comment">// reset time_slot to avoid sending old data; ank</span>
    <a class="code" href="ZMD_8h.html#a7deb9081234bdc9cdb6069bb8f05cf6a">timeslot_number</a> = 0; 
    
    <a class="code" href="pm__config__protocol_8h.html#ab14eb7224e6881cf15cb95391749de25">timeout_timer</a> = 0;
    
    <span class="comment">// start timer</span>
    TCCR1B = 0x09; <span class="comment">// CTC, no prescaling</span>
    TIFR1 = 0x02;       <span class="comment">// clear output compare a match flag</span>
    
    sei();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_aedc96a40e844bc2efc8bbef1b0782702_cgraph.png" border="0" usemap="#WEPO41104A00_8h_aedc96a40e844bc2efc8bbef1b0782702_cgraph" alt=""/></div>
<map name="WEPO41104A00_8h_aedc96a40e844bc2efc8bbef1b0782702_cgraph" id="WEPO41104A00_8h_aedc96a40e844bc2efc8bbef1b0782702_cgraph">
<area shape="rect" id="node3" href="ds620_8c.html#aa8ab08bf72368a272b8e137b37292ad9" title="Initialisiert den DS620." alt="" coords="114,107,195,133"/><area shape="rect" id="node13" href="WEPO41104A00_8h.html#ab15cf82f0329bc4d7262c03559eaaa8e" title="init_adc" alt="" coords="121,157,188,184"/><area shape="rect" id="node15" href="group__group__SX8723c__service.html#ga6e062d659b6b58d80823c2b664ec17f0" title="SX8723c_start" alt="" coords="101,208,208,235"/><area shape="rect" id="node5" href="ds620_8c.html#a126fb46cf24425d874541b7f95a927b7" title="Initialisiert die TWI für den Temperatursensor." alt="" coords="301,5,405,32"/><area shape="rect" id="node7" href="ds620_8c.html#aeb28edfed306ba8eceff10e8636852f0" title="sendet ein Byte über die TWI" alt="" coords="296,56,411,83"/><area shape="rect" id="node9" href="ds620_8c.html#aff3cc7b39da66e7aba8c3027edf2f6f0" title="Erzeugt die I²C&#45;Startbedingung und sendet die Chipadresse." alt="" coords="297,107,410,133"/><area shape="rect" id="node11" href="ds620_8c.html#a7b0b36fec2acaa9f4592b3390c1f6976" title="Erzeugt eine Stop&#45;Bedingung auf der TWI." alt="" coords="297,157,409,184"/><area shape="rect" id="node17" href="sw__twi_8h.html#a97a103cc9aeea7d86299b5c97b90751a" title="Brief description of this function." alt="" coords="257,208,450,235"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_aedc96a40e844bc2efc8bbef1b0782702_icgraph.png" border="0" usemap="#WEPO41104A00_8h_aedc96a40e844bc2efc8bbef1b0782702_icgraph" alt=""/></div>
<map name="WEPO41104A00_8h_aedc96a40e844bc2efc8bbef1b0782702_icgraph" id="WEPO41104A00_8h_aedc96a40e844bc2efc8bbef1b0782702_icgraph">
<area shape="rect" id="node3" href="WEPO41104A00_8c.html#a36cd53f29e25f87810b0a5156616fb99" title="Interrupt des analog&#45;Komperators, wird ausgeführt, wenn die Radialbeschleunigung über 2g steigt..." alt="" coords="105,5,148,32"/><area shape="rect" id="node5" href="WEPO41104A00_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="Hauptroutine." alt="" coords="101,56,152,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7b8ab79df77b57475a5494f5f81c3bd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="WEPO41104A00_8c.html#a7b8ab79df77b57475a5494f5f81c3bd9">timer_init</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialisiert den Timer1 auf Interrupt im Intervall der Samplerate. </p>

<p>Definition at line <a class="el" href="WEPO41104A00_8c_source.html#l00383">383</a> of file <a class="el" href="WEPO41104A00_8c_source.html">WEPO41104A00.c</a>.</p>

<p>References <a class="el" href="WEPO41104A00_8c_source.html#l00234">eeprom_sram_data</a>, <a class="el" href="pal__config_8h_source.html#l00079">F_CPU</a>, and <a class="el" href="eeprom__abbild_8h_source.html#l00077">eeprom_data::samplerate</a>.</p>

<p>Referenced by <a class="el" href="WEPO41104A00_8c_source.html#l00396">avr_init()</a>, and <a class="el" href="pm__config__protocol_8c_source.html#l00012">pm_config_protocol()</a>.</p>
<div class="fragment"><pre class="fragment">{
    TCCR1A = 0x00; <span class="comment">// CTC (clear timer on compare)</span>
    TCCR1B = 0x09; <span class="comment">// CTC, no prescaling</span>
    OCR1A = (<span class="keywordtype">unsigned</span> short) ((<span class="keywordtype">float</span>) <a class="code" href="pal__config_8h.html#a43bafb28b29491ec7f871319b5a3b2f8">F_CPU</a>
            / (float) <a class="code" href="pm__config__protocol_8h.html#a7f3aacb710fc6ba60196588850cf6d15">eeprom_sram_data</a>.<a class="code" href="structeeprom__data.html#a41f5e80711c080ba2e96138d33fd640e">samplerate</a>); <span class="comment">// Timer auf Samplerate einstellen</span>
    TCNT1 = 0x0000;
    OCR1B = 0x0000;
    ICR1 = 0x0000;
    TIMSK1 = 1 &lt;&lt; OCIE1A; <span class="comment">// Timer1 Output Compare A Match, interrupt enable</span>
    TIFR1 = 0x02;       <span class="comment">// clear output compare a match flag</span>
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="WEPO41104A00_8h_a7b8ab79df77b57475a5494f5f81c3bd9_icgraph.png" border="0" usemap="#WEPO41104A00_8h_a7b8ab79df77b57475a5494f5f81c3bd9_icgraph" alt=""/></div>
<map name="WEPO41104A00_8h_a7b8ab79df77b57475a5494f5f81c3bd9_icgraph" id="WEPO41104A00_8h_a7b8ab79df77b57475a5494f5f81c3bd9_icgraph">
<area shape="rect" id="node3" href="WEPO41104A00_8c.html#a4ae6edab9a918f82c63b98920fa10f1c" title="Grundlegende initialisierungen des Controlers und der Peripherie." alt="" coords="165,5,227,32"/><area shape="rect" id="node7" href="pm__config__protocol_8c.html#abcc456d73d4fc7a801c502e2ccf9b5c9" title="Behandelt empfangene Pakete zur Konfiguration." alt="" coords="129,56,263,83"/><area shape="rect" id="node5" href="WEPO41104A00_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="Hauptroutine." alt="" coords="312,31,363,57"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 26 2013 14:36:52 for SPIKE 1.1 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
